# =============================================================================
# HARDWARE-INDEPENDENT CONFIGURATION (Common for all targets)
# =============================================================================

# -----------------------------------------------------------------------------
# WiFi Configuration (same network regardless of hardware)
# -----------------------------------------------------------------------------
CONFIG_AG_WIFI_SSID="WIFI_SID"
CONFIG_AG_WIFI_PASSWORD="WIFI_PASSWORD"

# -----------------------------------------------------------------------------
# Application Features (hardware-independent)
# -----------------------------------------------------------------------------
# WebRTC Configuration
CONFIG_WEBRTC_PROVIDER_OPENAI=y
CONFIG_AG_WEBRTC_SUPPORT_OPUS=y
CONFIG_AG_WEBRTC_DATA_CHANNEL_ENABLED=y

# Vision Configuration
CONFIG_AG_VISION_PREVIEW_PORT=8080

# Camera Configuration
CONFIG_AG_VISION_DEFAULT_FPS=15
CONFIG_AG_VISION_DEFAULT_QUALITY=1
CONFIG_AG_VISION_JPEG_QUALITY=10
CONFIG_AG_VISION_BUFFER_FRAMES=3

# Recording Configuration
CONFIG_AG_VISION_CAPTURE_INTERVAL_MS=500

# Audio Configuration
CONFIG_AG_AUDIO_DEFAULT_PLAYBACK_VOL=75
CONFIG_AG_AUDIO_DEFAULT_MIC_GAIN=95

# -----------------------------------------------------------------------------
# Network Protocols (common for all hardware)
# -----------------------------------------------------------------------------
# Support 2 SNTP servers
CONFIG_LWIP_SNTP_MAX_SERVERS=2

# Enable DTLS SRTP for WebRTC
CONFIG_MBEDTLS_SSL_PROTO_DTLS=y
CONFIG_MBEDTLS_SSL_DTLS_SRTP=y
CONFIG_MBEDTLS_X509_CREATE_C=y

# -----------------------------------------------------------------------------
# Debug & Development Features (common)
# -----------------------------------------------------------------------------
# Enable GDBStub for debugging
CONFIG_ESP_SYSTEM_PANIC_GDBSTUB=y

# FreeRTOS trace facility moved to Memory Optimization section

# Task watchdog for stability
CONFIG_ESP_TASK_WDT_EN=y
CONFIG_ESP_TASK_WDT_TIMEOUT_S=15

# Increase stack watermark checking to ensure stability
CONFIG_FREERTOS_CHECK_STACKOVERFLOW_CANARY=y
CONFIG_FREERTOS_WATCHPOINT_END_OF_STACK=y

# Enable experimental features
CONFIG_IDF_EXPERIMENTAL_FEATURES=y

# -----------------------------------------------------------------------------
# Common Memory & Task Configuration
# -----------------------------------------------------------------------------
# Scheduler optimizations - reduced for memory
CONFIG_FREERTOS_IDLE_TASK_STACKSIZE=1536
CONFIG_FREERTOS_TIMER_TASK_STACK_DEPTH=2048
CONFIG_ESP_MAIN_TASK_STACK_SIZE=4096
CONFIG_ESP_SYSTEM_EVENT_TASK_STACK_SIZE=2560

# -----------------------------------------------------------------------------
# Build Optimizations (common)
# -----------------------------------------------------------------------------
CONFIG_COMPILER_OPTIMIZATION_SIZE=y

# Use custom partition table
CONFIG_PARTITION_TABLE_CUSTOM=y
CONFIG_PARTITION_TABLE_CUSTOM_FILENAME="partitions.csv"

# -----------------------------------------------------------------------------
# OpenAI Vision API Configuration
# -----------------------------------------------------------------------------
CONFIG_AG_VISION_REALTIME_FRAMES_COUNT=2

# -----------------------------------------------------------------------------
# OpenAI Realtime API Configuration
# -----------------------------------------------------------------------------
CONFIG_AG_OPENAI_REALTIME_MODEL="gpt-realtime"
CONFIG_AG_OPENAI_TOOL_CHOICE="auto"
CONFIG_AG_OPENAI_VOICE="ash"

# -----------------------------------------------------------------------------
# Memory Optimization Settings
# -----------------------------------------------------------------------------
# Reduce WiFi buffers
CONFIG_ESP32_WIFI_STATIC_RX_BUFFER_NUM=4
CONFIG_ESP32_WIFI_DYNAMIC_RX_BUFFER_NUM=8
CONFIG_ESP32_WIFI_STATIC_TX_BUFFER_NUM=4
CONFIG_ESP32_WIFI_TX_BUFFER_TYPE=0
CONFIG_ESP32_WIFI_RX_BA_WIN=4
CONFIG_ESP32_WIFI_AMPDU_TX_ENABLED=n
CONFIG_ESP32_WIFI_AMPDU_RX_ENABLED=y

# Reduce LWIP buffers
CONFIG_LWIP_TCP_SND_BUF_DEFAULT=4096
CONFIG_LWIP_TCP_WND_DEFAULT=4096
CONFIG_LWIP_TCP_RECVMBOX_SIZE=6
CONFIG_LWIP_UDP_RECVMBOX_SIZE=6
CONFIG_LWIP_TCPIP_RECVMBOX_SIZE=16

# HTTP client optimizations
CONFIG_ESP_HTTP_CLIENT_ENABLE_HTTPS=y
CONFIG_MBEDTLS_DYNAMIC_BUFFER=y
CONFIG_MBEDTLS_DYNAMIC_FREE_CONFIG_DATA=y
CONFIG_MBEDTLS_DYNAMIC_FREE_CA_CERT=y

# Disable unnecessary features
CONFIG_ESP32_DEBUG_OCDAWARE=n
# Keep trace facility enabled - required by memory_manager.c
CONFIG_FREERTOS_USE_TRACE_FACILITY=y
CONFIG_FREERTOS_VTASKLIST_INCLUDE_COREID=y
CONFIG_FREERTOS_GENERATE_RUN_TIME_STATS=y
